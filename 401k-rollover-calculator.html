<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>401k Rollover Comparison — Young Budgeteer</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #efefef;
      color: #222;
      min-height: 100vh;
    }

    header {
      background: #0B7D67;
      color: white;
      padding: 36px 24px 28px;
      text-align: center;
    }

    header h1 { font-size: 1.8rem; font-weight: 700; }
    header p  { margin-top: 6px; opacity: 0.88; font-size: 1rem; }

    .calc-wrapper {
      max-width: 880px;
      margin: 0 auto;
      padding: 28px 16px 60px;
    }

    .explainer {
      background: #e8f5f2;
      border-left: 4px solid #0B7D67;
      border-radius: 0 6px 6px 0;
      padding: 14px 18px;
      margin-bottom: 20px;
      font-size: 0.88rem;
      color: #333;
      line-height: 1.6;
    }

    .explainer strong { color: #0B7D67; }

    /* Side-by-side input cards */
    .compare-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    @media (max-width: 600px) { .compare-grid { grid-template-columns: 1fr; } }

    .card {
      background: white;
      border-radius: 10px;
      padding: 22px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.07);
    }

    .card.old-401k { border-top: 4px solid #e07b39; }
    .card.new-ira  { border-top: 4px solid #0B7D67; }
    .card.shared   { margin-bottom: 20px; }

    .card h2 {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-weight: 700;
      margin-bottom: 16px;
      padding-bottom: 10px;
      border-bottom: 2px solid;
    }

    .card.old-401k h2 { color: #e07b39; border-color: #fdf0e8; }
    .card.new-ira  h2 { color: #0B7D67; border-color: #e8f5f2; }
    .card.shared   h2 { color: #555;    border-color: #eee; }

    .field { margin-bottom: 14px; }
    .field:last-child { margin-bottom: 0; }

    label {
      display: block;
      font-size: 0.73rem;
      font-weight: 600;
      color: #666;
      margin-bottom: 5px;
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }

    .input-wrap { position: relative; }

    .input-wrap .pre,
    .input-wrap .suf {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      color: #999;
      font-size: 0.88rem;
      pointer-events: none;
    }

    .input-wrap .pre { left: 10px; }
    .input-wrap .suf { right: 10px; }

    input[type="number"],
    select {
      width: 100%;
      padding: 9px 12px;
      border: 1.5px solid #ddd;
      border-radius: 6px;
      font-size: 0.92rem;
      color: #222;
      background: white;
      transition: border-color 0.15s;
      -moz-appearance: textfield;
    }

    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; }

    input[type="number"]:focus,
    select:focus { outline: none; border-color: #0B7D67; }

    .has-pre input { padding-left: 24px; }
    .has-suf input { padding-right: 32px; }

    .hint { font-size: 0.73rem; color: #bbb; margin-top: 3px; }

    .shared-grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 16px;
    }

    @media (max-width: 580px) { .shared-grid { grid-template-columns: 1fr 1fr; } }

    .calc-btn {
      display: block;
      width: 100%;
      padding: 14px;
      background: #0B7D67;
      color: white;
      font-size: 1rem;
      font-weight: 700;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.15s;
      margin-bottom: 28px;
    }

    .calc-btn:hover { background: #096b57; }

    .hidden { display: none; }

    /* Verdict banner */
    .verdict {
      border-radius: 10px;
      padding: 18px 22px;
      margin-bottom: 20px;
      font-size: 1rem;
      font-weight: 600;
      line-height: 1.5;
      border: 2px solid #0B7D67;
      background: #e8f5f2;
      color: #0B7D67;
      text-align: center;
    }

    /* Metrics */
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 14px;
      margin-bottom: 20px;
    }

    .metric {
      background: white;
      border-radius: 10px;
      padding: 18px 14px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.07);
      text-align: center;
    }

    .metric .mlabel { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.06em; color: #999; font-weight: 600; margin-bottom: 6px; }
    .metric .mvalue { font-size: 1.4rem; font-weight: 700; color: #0B7D67; line-height: 1.1; }
    .metric .msub   { font-size: 0.72rem; color: #bbb; margin-top: 4px; }
    .metric.orange .mvalue { color: #e07b39; }
    .metric.win    { border: 2px solid #0B7D67; }

    /* Charts */
    .chart-card {
      background: white;
      border-radius: 10px;
      padding: 22px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.07);
      margin-bottom: 20px;
    }

    .chart-card h3 {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #0B7D67;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .chart-card p { font-size: 0.78rem; color: #aaa; margin-bottom: 16px; }

    .chart-wrap { position: relative; height: 280px; }

    /* Fee impact panel */
    .fee-panel {
      background: white;
      border-radius: 10px;
      padding: 22px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.07);
      margin-bottom: 20px;
      border-left: 5px solid #e07b39;
    }

    .fee-panel h3 {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #e07b39;
      font-weight: 700;
      margin-bottom: 14px;
    }

    .fee-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 9px 0;
      border-bottom: 1px solid #f5f5f5;
      font-size: 0.9rem;
    }

    .fee-row:last-child { border-bottom: none; }
    .fee-label { color: #555; }
    .fee-value { font-weight: 700; }
    .fee-value.bad  { color: #c0392b; }
    .fee-value.good { color: #0B7D67; }
    .fee-value.save { color: #0B7D67; font-size: 1.05rem; }

    /* Table */
    .table-card {
      background: white;
      border-radius: 10px;
      padding: 22px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.07);
      overflow-x: auto;
    }

    .table-card h3 {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #0B7D67;
      font-weight: 700;
      margin-bottom: 16px;
    }

    table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
    thead tr { background: #0B7D67; color: white; }
    thead th { padding: 10px 14px; text-align: right; font-weight: 600; white-space: nowrap; }
    thead th:first-child { text-align: center; }
    tbody tr:nth-child(even) { background: #f7faf9; }
    tbody td { padding: 9px 14px; text-align: right; border-bottom: 1px solid #eee; white-space: nowrap; }
    tbody td:first-child { text-align: center; font-weight: 600; }
    .better { color: #0B7D67; font-weight: 700; }
  </style>
</head>
<body>

<header>
  <h1>401k Rollover Comparison</h1>
  <p>Left a job? See exactly what fees cost you — and whether rolling over is worth it.</p>
</header>

<div class="calc-wrapper">

  <div class="explainer">
    When you leave an employer, your 401k doesn't disappear — it just sits there. The question is
    whether to leave it with the old provider or roll it over to an IRA you control.
    The difference often comes down to one thing: <strong>fees</strong>. Even a 1% annual fee looks
    harmless on paper, but compounded over 20–30 years it can quietly eat tens of thousands
    of dollars from your retirement. This calculator shows you the real number.
  </div>

  <!-- Side-by-side input cards -->
  <div class="compare-grid">

    <div class="card old-401k">
      <h2>Old 401k (Leave It)</h2>
      <div class="field">
        <label for="currentBalance">Current Balance</label>
        <div class="input-wrap has-pre">
          <span class="pre">$</span>
          <input type="number" id="currentBalance" value="35000" min="0">
        </div>
      </div>
      <div class="field">
        <label for="oldFees">Total Annual Fees</label>
        <div class="input-wrap has-suf">
          <input type="number" id="oldFees" value="1.0" min="0" max="5" step="0.05">
          <span class="suf">%</span>
        </div>
        <div class="hint">Expense ratios + admin/advisory fees combined. Check your plan documents — 0.5–1.5% is common.</div>
      </div>
      <div class="field">
        <label for="oldContrib">Monthly Contributions</label>
        <div class="input-wrap has-pre">
          <span class="pre">$</span>
          <input type="number" id="oldContrib" value="0" min="0">
        </div>
        <div class="hint">Usually $0 — you left the employer, so no new contributions</div>
      </div>
    </div>

    <div class="card new-ira">
      <h2>New IRA (Roll It Over)</h2>
      <div class="field">
        <label>Transfer Amount</label>
        <div class="input-wrap has-pre">
          <span class="pre">$</span>
          <input type="number" value="" id="transferAmt" placeholder="Same as balance above" min="0">
        </div>
        <div class="hint">Leave blank to use the full balance. A direct rollover has no taxes or penalties.</div>
      </div>
      <div class="field">
        <label for="newFees">Total Annual Fees</label>
        <div class="input-wrap has-suf">
          <input type="number" id="newFees" value="0.05" min="0" max="5" step="0.01">
          <span class="suf">%</span>
        </div>
        <div class="hint">Low-cost index funds at Fidelity/Vanguard/M1 run 0.03–0.1%. This is the big win.</div>
      </div>
      <div class="field">
        <label for="newContrib">Monthly Contributions</label>
        <div class="input-wrap has-pre">
          <span class="pre">$</span>
          <input type="number" id="newContrib" value="500" min="0">
        </div>
        <div class="hint">New IRA contributions going forward (2024 limit: $7,000/yr)</div>
      </div>
    </div>

  </div>

  <!-- Shared assumptions -->
  <div class="card shared">
    <h2>Assumptions</h2>
    <div class="shared-grid">
      <div class="field">
        <label for="annualReturn">Expected Annual Return</label>
        <div class="input-wrap has-suf">
          <input type="number" id="annualReturn" value="8" min="0" max="20" step="0.1">
          <span class="suf">%</span>
        </div>
        <div class="hint">Before fees. Historical stock market avg ~10%; 7–8% is a common conservative estimate.</div>
      </div>
      <div class="field">
        <label for="yearsToGrow">Years to Grow</label>
        <select id="yearsToGrow">
          <option value="10">10 years</option>
          <option value="15">15 years</option>
          <option value="20">20 years</option>
          <option value="25">25 years</option>
          <option value="30" selected>30 years</option>
          <option value="35">35 years</option>
          <option value="40">40 years</option>
        </select>
        <div class="hint">Until retirement or when you plan to withdraw</div>
      </div>
      <div class="field">
        <label for="taxRate">Marginal Tax Rate (optional)</label>
        <div class="input-wrap has-suf">
          <input type="number" id="taxRate" value="22" min="0" max="50" step="1">
          <span class="suf">%</span>
        </div>
        <div class="hint">Used to estimate after-tax value at withdrawal. Enter 0 to skip.</div>
      </div>
    </div>
  </div>

  <button class="calc-btn" onclick="calculate()">Compare My Options</button>

  <!-- Results -->
  <div id="results" class="hidden">

    <div id="verdictBanner" class="verdict"></div>

    <div class="metrics-grid" id="metricsGrid"></div>

    <div class="fee-panel">
      <h3>The Real Cost of Fees</h3>
      <div class="fee-row">
        <span class="fee-label">Old 401k fees paid over <span id="feeYears1"></span> years</span>
        <span class="fee-value bad" id="oldFeesPaid"></span>
      </div>
      <div class="fee-row">
        <span class="fee-label">New IRA fees paid over <span id="feeYears2"></span> years</span>
        <span class="fee-value good" id="newFeesPaid"></span>
      </div>
      <div class="fee-row">
        <span class="fee-label">Fees saved by rolling over</span>
        <span class="fee-value save" id="feesSaved"></span>
      </div>
      <div class="fee-row">
        <span class="fee-label">What those saved fees could grow to (if invested)</span>
        <span class="fee-value save" id="feesGrowth"></span>
      </div>
    </div>

    <div class="chart-card">
      <h3>Portfolio Growth Over Time</h3>
      <p>Both accounts, fee impact included. The gap widens every year.</p>
      <div class="chart-wrap">
        <canvas id="growthChart"></canvas>
      </div>
    </div>

    <div class="chart-card">
      <h3>Cumulative Fees Paid Over Time</h3>
      <p>How much of your own money goes to the fund managers, not you.</p>
      <div class="chart-wrap" style="height:200px">
        <canvas id="feeChart"></canvas>
      </div>
    </div>

    <div class="table-card">
      <h3>Year-by-Year Comparison</h3>
      <table>
        <thead>
          <tr>
            <th>Year</th>
            <th>Old 401k Balance</th>
            <th>Fees Paid (Old)</th>
            <th>New IRA Balance</th>
            <th>Fees Paid (New)</th>
            <th>IRA Advantage</th>
          </tr>
        </thead>
        <tbody id="tableBody"></tbody>
      </table>
    </div>

  </div>

</div>

<script>
  let growthChart = null, feeChart = null;

  function $ (id) { return document.getElementById(id); }
  function val(id) { return parseFloat($(id).value) || 0; }

  function fmt(n) {
    if (Math.abs(n) >= 1000000) return '$' + (n / 1000000).toFixed(2) + 'M';
    return '$' + Math.round(n).toLocaleString();
  }

  function calculate() {
    const balance     = val('currentBalance');
    const oldFeesPct  = val('oldFees') / 100;
    const oldContrib  = val('oldContrib');
    const transferAmt = val('transferAmt') || balance;
    const newFeesPct  = val('newFees') / 100;
    const newContrib  = val('newContrib');
    const annReturn   = val('annualReturn') / 100;
    const years       = parseInt($('yearsToGrow').value);
    const taxRate     = val('taxRate') / 100;

    const mReturn = annReturn / 12;

    // Simulate month by month for both accounts
    let oldBal = balance;
    let newBal = transferAmt;

    let cumulOldFees = 0;
    let cumulNewFees = 0;
    // Track fees saved invested separately
    let feeSavingsInvested = 0;

    const yearlyData = [];

    for (let y = 1; y <= years; y++) {
      let oldYearFees = 0, newYearFees = 0;

      for (let m = 0; m < 12; m++) {
        // Grow
        oldBal = oldBal * (1 + mReturn) + oldContrib;
        newBal = newBal * (1 + mReturn) + newContrib;

        // Deduct annual fees monthly (proportional)
        const oldMonthFee = oldBal * (oldFeesPct / 12);
        const newMonthFee = newBal * (newFeesPct / 12);

        oldBal -= oldMonthFee;
        newBal -= newMonthFee;

        oldYearFees += oldMonthFee;
        newYearFees += newMonthFee;

        // Compound the fee savings
        const feeSavedThisMonth = oldMonthFee - newMonthFee;
        feeSavingsInvested = feeSavingsInvested * (1 + mReturn) + Math.max(0, feeSavedThisMonth);
      }

      cumulOldFees += oldYearFees;
      cumulNewFees += newYearFees;

      yearlyData.push({
        year: y,
        oldBal, newBal,
        cumulOldFees, cumulNewFees,
        advantage: newBal - oldBal
      });
    }

    const last = yearlyData[yearlyData.length - 1];

    render({
      years, oldFeesPct, newFeesPct,
      yearlyData, last,
      cumulOldFees, cumulNewFees,
      feeSavingsInvested,
      taxRate,
      oldContrib, newContrib
    });
  }

  function render(d) {
    $('results').classList.remove('hidden');

    const advantage    = d.last.newBal - d.last.oldBal;
    const afterTaxOld  = d.taxRate > 0 ? d.last.oldBal * (1 - d.taxRate) : null;
    const afterTaxNew  = d.taxRate > 0 ? d.last.newBal * (1 - d.taxRate) : null;

    // Verdict
    const vb = $('verdictBanner');
    if (advantage > 0) {
      vb.textContent = `Rolling over to a lower-fee IRA puts ${fmt(advantage)} more in your pocket after ${d.years} years. That's money your old 401k's fees would have quietly taken from you.`;
    } else {
      vb.textContent = `With these numbers, leaving the funds actually comes out slightly ahead — likely because of the additional IRA contributions factored in. Adjust the inputs and compare.`;
    }

    // Fee years labels
    $('feeYears1').textContent = d.years;
    $('feeYears2').textContent = d.years;

    const feesSaved = d.cumulOldFees - d.cumulNewFees;
    $('oldFeesPaid').textContent  = fmt(d.cumulOldFees);
    $('newFeesPaid').textContent  = fmt(d.cumulNewFees);
    $('feesSaved').textContent    = fmt(Math.max(0, feesSaved));
    $('feesGrowth').textContent   = fmt(d.feeSavingsInvested);

    // Metric cards
    $('metricsGrid').innerHTML = `
      <div class="metric orange">
        <div class="mlabel">Old 401k After ${d.years} Yrs</div>
        <div class="mvalue">${fmt(d.last.oldBal)}</div>
        <div class="msub">${(d.oldFeesPct * 100).toFixed(2)}% annual fees${afterTaxOld ? ' · ' + fmt(afterTaxOld) + ' after tax' : ''}</div>
      </div>
      <div class="metric win">
        <div class="mlabel">New IRA After ${d.years} Yrs</div>
        <div class="mvalue">${fmt(d.last.newBal)}</div>
        <div class="msub">${(d.newFeesPct * 100).toFixed(2)}% annual fees${afterTaxNew ? ' · ' + fmt(afterTaxNew) + ' after tax' : ''}</div>
      </div>
      <div class="metric">
        <div class="mlabel">IRA Advantage</div>
        <div class="mvalue">${fmt(advantage)}</div>
        <div class="msub">Extra retirement savings by rolling over</div>
      </div>
      <div class="metric">
        <div class="mlabel">Fee Drag (Old 401k)</div>
        <div class="mvalue">${fmt(d.cumulOldFees)}</div>
        <div class="msub">Total fees paid to old provider</div>
      </div>
      <div class="metric">
        <div class="mlabel">Fee Savings Invested</div>
        <div class="mvalue">${fmt(d.feeSavingsInvested)}</div>
        <div class="msub">If saved fees were reinvested at same return</div>
      </div>
    `;

    // Growth chart
    const labels    = d.yearlyData.map(r => `Yr ${r.year}`);
    const oldLine   = d.yearlyData.map(r => Math.round(r.oldBal));
    const newLine   = d.yearlyData.map(r => Math.round(r.newBal));

    if (growthChart) growthChart.destroy();
    growthChart = new Chart($('growthChart').getContext('2d'), {
      type: 'line',
      data: {
        labels,
        datasets: [
          {
            label: 'New IRA (Roll Over)',
            data: newLine,
            borderColor: '#0B7D67',
            backgroundColor: 'rgba(11,125,103,0.07)',
            borderWidth: 2.5,
            pointRadius: 2,
            tension: 0.3,
            fill: true
          },
          {
            label: 'Old 401k (Leave It)',
            data: oldLine,
            borderColor: '#e07b39',
            backgroundColor: 'transparent',
            borderWidth: 2.5,
            pointRadius: 2,
            tension: 0.3,
            borderDash: [5, 3],
            fill: false
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: 'top' },
          tooltip: { callbacks: { label: ctx => ` ${ctx.dataset.label}: $${ctx.parsed.y.toLocaleString()}` } }
        },
        scales: {
          y: { ticks: { callback: v => v >= 1000000 ? '$' + (v/1000000).toFixed(1) + 'M' : '$' + (v/1000).toFixed(0) + 'k' } }
        }
      }
    });

    // Fee chart
    const oldFees = d.yearlyData.map(r => Math.round(r.cumulOldFees));
    const newFees = d.yearlyData.map(r => Math.round(r.cumulNewFees));

    if (feeChart) feeChart.destroy();
    feeChart = new Chart($('feeChart').getContext('2d'), {
      type: 'line',
      data: {
        labels,
        datasets: [
          {
            label: 'Old 401k Fees',
            data: oldFees,
            borderColor: '#c0392b',
            backgroundColor: 'rgba(192,57,43,0.07)',
            borderWidth: 2,
            pointRadius: 1,
            tension: 0.3,
            fill: true
          },
          {
            label: 'New IRA Fees',
            data: newFees,
            borderColor: '#0B7D67',
            backgroundColor: 'transparent',
            borderWidth: 2,
            pointRadius: 1,
            tension: 0.3,
            fill: false
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: 'top' },
          tooltip: { callbacks: { label: ctx => ` ${ctx.dataset.label}: $${ctx.parsed.y.toLocaleString()}` } }
        },
        scales: {
          y: { ticks: { callback: v => '$' + (v/1000).toFixed(0) + 'k' } }
        }
      }
    });

    // Table
    $('tableBody').innerHTML = d.yearlyData
      .filter((r, i) => i === 0 || (r.year % 5 === 0) || r.year === d.years)
      .map(r => {
        const adv = r.newBal - r.oldBal;
        return `<tr>
          <td>${r.year}</td>
          <td>${fmt(r.oldBal)}</td>
          <td style="color:#c0392b">${fmt(r.cumulOldFees)}</td>
          <td>${fmt(r.newBal)}</td>
          <td style="color:#0B7D67">${fmt(r.cumulNewFees)}</td>
          <td class="better">${fmt(adv)}</td>
        </tr>`;
      }).join('');

    $('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
</script>
</body>
</html>
